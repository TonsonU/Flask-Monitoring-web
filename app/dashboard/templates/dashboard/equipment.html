{% extends "dashboard/dashboard.html" %}

{% block dashboard_content %}

<div id="location-dashboard" class="container-fluid">
    <div class="row mb-4">
        <div class="d-flex justify-content-between align-items-center flex-wrap">
            <h2 class="fw-bold mb-3 me-3">Equipment Overview</h2>
            <!-- ‡∏™‡πà‡∏ß‡∏ô Toggle ‡∏õ‡∏£‡∏±‡∏ö theme ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß -->
        </div>
              
        <!-- üìå Dropdown Filter -->
        <div class="col-12 mb-4">
            <label for="equipmentFilter" class="form-label fw-semibold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå: </label>
            <select id="equipmentFilter" class="form-select custom-dropdown w-auto d-inline-block">
                <option value="">-- ‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
            </select>
        </div>

        <!-- ‚úÖ Charts Section -->
        <div class="row g-4">

            <!-- Pie: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏≤‡∏ô CM -->
            <div class="col-lg-6 col-md-12">
                <div class="card shadow-sm rounded-4 text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title fw-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏≤‡∏ô CM</h5>
                        <canvas id="work-count-by-equipment-chart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Pie: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
            <div class="col-lg-6 col-md-12">
                <div class="card shadow-sm rounded-4 text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title fw-bold">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏° (Open / Closed)</h5>
                        <canvas id="status-pie-chart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Line: ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ -->
            <div class="col-lg-6 col-md-12">
                <div class="card shadow-sm rounded-4 text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title fw-bold">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (‡∏õ‡∏µ)</h5>
                        <canvas id="work-trend-line-chart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Line: ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô -->
            <div class="col-lg-6 col-md-12">
                <div class="card shadow-sm rounded-4 text-center position-relative h-100">
                    <div class="card-body pt-4">
                        <h5 class="card-title fw-bold mb-3">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</h5>
                        <!-- üìå Dropdown ‡∏õ‡∏µ (‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô) -->
                        <select id="monthYearSelect"
                                class="form-select form-select-sm position-absolute"
                                style="top: 1rem; right: 1rem; width: auto; max-width: 150px;">
                        </select>
                        <canvas id="monthly-trend-line-chart" style="max-height: 285px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Bar: Location Breakdown -->
            <div class="col-lg-6 col-md-12">
                <div class="card shadow-sm rounded-4 text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title fw-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏≤‡∏ô CM ‡πÅ‡∏ï‡πà‡∏•‡∏∞ Location</h5>
                        <canvas id="device-location-breakdown-chart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Bar: Device Breakdown -->
            <div class="col-lg-6 col-md-12">
                <div class="card shadow-sm rounded-4 text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title fw-bold">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏Ñ‡∏™‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h5>
                        <canvas id="breakdown-equipment-chart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Point Case Chart -->
            <div id="point-card" class="col-lg-6 col-md-12" style="display: none;">
                <div class="card shadow-sm rounded-4 text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title fw-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏Ñ‡∏™ CM ‡∏Ç‡∏≠‡∏á Point</h5>
                        <canvas id="point-case-chart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Cause Case Chart -->
            <div id="cause-card" class="col-lg-6 col-md-12" style="display: none;">
                <div class="card shadow-sm rounded-4 text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title fw-bold">‡πÄ‡∏Ñ‡∏™ CM ‡∏Ç‡∏≠‡∏á Point ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å</h5>
                        <canvas id="cause-case-chart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='equipment_dashboard.js') }}"></script>

    
<style>
    .card {
        transition: transform 0.2s ease-in-out;
    }
    .card:hover {
        transform: translateY(-4px);
    }

    .form-select.custom-dropdown {
        min-width: 220px;
    }

    canvas {
        width: 100% !important;
        height: auto !important;
    }

    
</style>

{% endblock %}
